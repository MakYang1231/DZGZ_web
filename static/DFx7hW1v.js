import{_ as W,a as X,b as Y,c as Z}from"./DTBLLM4h.js";import{u as tt,c as et,a as ot,b as st}from"./DbszNA4r.js";import{f as nt}from"./clxyF2lu.js";import{d as at,a as l,M as lt,x as g,N as it,z as r,A as c,D as o,F as a,B as d,C as p,u as _,O as $,P as k,Q as h,E as f,R as j}from"./orbDqLiy.js";const rt={class:"page_main container d-flex justify-content-between"},ct={class:"div_page_left col-md-2 bg-light"},_t=o("div",{class:"menu_title"},[o("div",null,"分類找商品")],-1),ut={class:"menu_item"},dt={class:"me-3"},pt={class:"text d-flex align-items-center"},mt={key:0},gt={class:"div_page_right col-md-9 col-12 bg-light"},ft={class:"page_header_breadcrumb d-flex align-items-center"},vt={class:"page_subItem d-flex align-items-center justify-content-between flex-wrap"},ht={class:"d-flex align-items-center justify-content-start control_bar"},yt=o("div",{class:"control_label"},"篩選",-1),bt={class:"control_options"},xt={class:"page_itemBody mt-3"},Ct={class:"d-flex align-items-baseline justify-content-between flex-wrap"},$t={class:""},kt={class:"title"},wt={key:0},Nt={class:"point"},Bt=o("button",{class:"nutton d-none"},"點數兌換",-1),Rt=at({__name:"note",async setup(Dt){let y,D;const M=tt().currentRoute.value,b=M.params.category;let S=l(!1),x=l([]),w=l([]),P=l("");const T=l(null),{$MenuItemsData:A}=st(),N=l(A);let n=l(),E=l([]);const m=l("");l(),lt(()=>{if(console.log(g(N.value)),g(N.value).forEach((t,i)=>{t.category_url===b&&(x=g(t),console.log(x),T.value.textContent=x.category_name,w.value=x.sub_categories,w.value.forEach((u,B)=>{u.sub_url===M.params.subCategory&&(P.value=u.sub_name)}),S.value=!0)}),!S.value)throw console.log("Not ==="),et({statusCode:404,statusMessage:"Page Not Found",fatal:!0});let e=l([]);n=l(g(n.value)),n?n=n.value.filter(t=>t.sub_category===P.value):console.log("No data");for(let t in n)e.value.push(n[t]);n=e});const{data:F,refresh:Mt}=([y,D]=it(()=>ot(`https://isnmk.com/api/${b}`,"$Rscdq200gu")),y=await y,D(),y);n=g(F.value);const v=e=>{m.value=e},H=(e,t)=>{let i=e.last_30days_sales*e.point,u=t.last_30days_sales*t.point;return i=i<=0?e.point:i,u=u<=0?t.point:u,u-i},I=(e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime(),L=(e,t)=>(e.point===""&&(e.last_30days_sales="0"),t.point===""&&(t.last_30days_sales="0"),t.last_30days_sales-e.last_30days_sales),O=(e,t)=>(e.point===""&&(e.point="99999"),t.point===""&&(t.point="99999"),t.point-e.point),V=(e,t)=>(e.point===""&&(e.point="99999"),t.point===""&&(t.point="99999"),e.point-t.point);for(let e in n)E.value.push(n[e]);n=E;const z=()=>{console.log(n),n.value.sort(H)},q=()=>{n.value.sort(I)},Q=()=>{n.value.sort(L)},G=()=>{n.value.sort(O)},J=()=>{console.log(g(n)),n.value.sort(V)};return(e,t)=>{const i=W,u=X,B=Y,K=Z;return r(),c("div",rt,[o("div",ct,[_t,a(),o("div",ut,[o("ul",dt,[d(u,null,{default:p(()=>[(r(!0),c($,null,k(_(N),(s,C)=>(r(),c("li",{key:C,class:"mx-3"},[d(i,{class:"d-flex align-items-center position-relative pb-2",to:`/${s.category_url}`},{default:p(()=>[o("div",pt,f(s.category_name),1)]),_:2},1032,["to"]),a(),s.sub_categories?(r(),c("div",mt,[(r(!0),c($,null,k(s.sub_categories,(R,U)=>(r(),c("div",{key:U,class:"page_Cat_Sub"},[d(i,{to:`/${s.category_url}/${R.sub_url}`},{default:p(()=>[a(f(R.sub_name),1)]),_:2},1032,["to"])]))),128))])):j("",!0)]))),128))]),_:1})])])]),a(),o("div",gt,[o("div",ft,[d(B,{name:"house-door-fill",class:"icon"}),a(),d(B,{name:"chevron-double-right",class:"icon mx-2"}),a(),d(i,{to:{path:`/${_(b)}`,hash:""}},{default:p(()=>[o("div",{ref_key:"DOM_ch_category",ref:T},null,512)]),_:1},8,["to"])]),a(),o("div",vt,[(r(!0),c($,null,k(_(w),(s,C)=>(r(),c("div",{class:"subItem_text bg-light col-4 col-md-3",key:C},[d(i,{to:`/${_(b)}/${s.sub_url}`},{default:p(()=>[a(f(s.sub_name),1)]),_:2},1032,["to"])]))),128))]),a(),o("div",ht,[yt,a(),o("div",bt,[o("button",{class:h({active:_(m)==="complex"}),onClick:t[0]||(t[0]=s=>{v("complex"),z()})},"綜合排名",2),a(),o("button",{class:h({active:_(m)==="time"}),onClick:t[1]||(t[1]=s=>{v("time"),q()})},"最新",2),a(),o("button",{class:h({active:_(m)==="hot"}),onClick:t[2]||(t[2]=s=>{v("hot"),Q()})},"最熱銷",2),a(),o("button",{class:h({active:_(m)==="point_height"}),onClick:t[3]||(t[3]=s=>{v("point_height"),G()})},"點數高",2),a(),o("button",{class:h({active:_(m)==="point_low"}),onClick:t[4]||(t[4]=s=>{v("point_low"),J()})},"點數低",2)])]),a(),o("div",xt,[d(u,null,{default:p(()=>[o("ul",Ct,[(r(!0),c($,null,k(_(n),(s,C)=>(r(),c("li",$t,[d(i,{class:"disabled-link",to:{path:"/",hash:""}},{default:p(()=>[d(K,{class:"lazyload",itemprop:"image",src:`${s.picture_url}`,"data-src":`${s.picture_url}`},null,8,["src","data-src"])]),_:2},1024),a(),o("div",kt,[a(f(s.item_name)+" ",1),s.spec!==""&&s.spec!=="無"?(r(),c("span",wt," : "+f(s.spec),1)):j("",!0)]),a(),o("div",Nt,f(("formatNumber"in e?e.formatNumber:_(nt))(s.point))+` 菓子點
                            `,1),a(),Bt]))),256))])]),_:1})])])])}}});export{Rt as default};
