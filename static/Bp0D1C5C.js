import{_ as d}from"./gJFvcO3S.js";import{a as p,c as m,L as f,F as k,G as c,y as r,B as g,A as y,z as u,N as h,u as v,O as x,a1 as S,a2 as N,C as l}from"./CHuaOox2.js";import{_ as B}from"./BWdRv1Sb.js";const E={__name:"index",setup(w){const a=p([]),i=m(()=>(console.log(a.value),a.value.slice().sort((e,o)=>e.user_rank-o.user_rank)));async function n(){try{const e=await $fetch("https://isnmk.com/point/rank_api_test");console.log(e.day_rank),_(e.day_rank),console.log("update")}catch(e){console.error("Error fetching data:",e)}}function _(e){JSON.stringify(e)!==JSON.stringify(a.value)&&(a.value=e)}return f(()=>{n();{const e=new EventSource("/DZGZ_web/api/sse");e.onmessage=o=>{const t=JSON.parse(o.data);console.log("client sse re ok"),t.type==="webhook-update"&&(console.log("Webhook update received:",t.data),n())},e.onerror=o=>{console.error("SSE Error:",o)}}}),(e,o)=>{const t=d;return r(),k(t,{name:"custom-layout"},{default:c(()=>[g("div",null,[y(S,{name:"list",tag:"ul"},{default:c(()=>[(r(!0),u(x,null,h(v(i),(s,O)=>(r(),u("li",{key:s.user_id,style:N({order:s.user_rank}),class:"list-item"},l(s.user_rank)+". "+l(s.user_name),5))),128))]),_:1})])]),_:1})}}},L=B(E,[["__scopeId","data-v-e1816d19"]]);export{L as default};
