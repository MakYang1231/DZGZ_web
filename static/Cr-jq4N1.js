import{_ as st,a as ot,b as nt,c as at}from"./DTBLLM4h.js";import{d as lt,a as p,M as it,x as $,N as rt,z as l,A as u,D as s,F as o,B as _,C as m,u as i,O as b,P as w,Q as x,E as h,R as F,U as ct,V as ut,H as _t,W as dt,X as pt}from"./orbDqLiy.js";import{u as mt,c as gt,a as ft,b as vt}from"./DbszNA4r.js";import{f as ht}from"./clxyF2lu.js";const yt={class:"page_main container d-flex justify-content-between"},bt={class:"div_page_left col-md-2 bg-light"},wt=s("div",{class:"menu_title"},[s("div",null,"分類找商品")],-1),xt={class:"menu_item"},Ct={class:"me-3"},St={class:"text d-flex align-items-center"},kt={key:0},$t={class:"div_page_right col-md-9 col-12 bg-light"},Bt={class:"page_header_breadcrumb d-flex align-items-center"},Nt={class:"page_subItem d-flex align-items-center justify-content-between flex-wrap"},Dt={class:"d-flex align-items-center justify-content-start control_bar"},Pt=s("div",{class:"control_label"},"篩選",-1),Mt={class:"control_options"},Rt={class:"page_itemBody mt-3"},Tt={class:"d-flex align-items-baseline justify-content-between flex-wrap"},Ht={class:""},jt={class:"title"},Et={key:0},Ft={class:"point"},Vt=s("button",{class:"nutton d-none"},"點數兌換",-1),V=18,Zt=lt({__name:"[subCategory]",async setup(zt){let C,D;const P=mt().currentRoute.value,S=P.params.category;let M=p(!1),B=p([]),N=p([]),R=p("");const T=p(null),{$MenuItemsData:z}=vt(),H=p(z);let r=p(),c=p();const f=p("");p(),it(()=>{if($(H.value).forEach((t,e)=>{t.category_url===S&&(B=$(t),T.value.textContent=B.category_name,N.value=B.sub_categories,N.value.forEach((n,g)=>{n.sub_url===P.params.subCategory&&(R.value=n.sub_name)}),M.value=!0)}),!M.value)throw console.log("Not ==="),gt({statusCode:404,statusMessage:"Page Not Found",fatal:!0});c.value=r,c?c.value=$(c.value).filter(t=>t.sub_category===R.value):console.log("No data"),c.value=v(c.value)});const{data:A,refresh:At}=([C,D]=rt(()=>ft(`https://isnmk.com/api/${S}`,"$yF3ZZRwgqw")),C=await C,D(),C);r=$(A.value);const y=t=>{f.value=t},I=(t,e)=>{let n=t.last_30days_sales*t.point,g=e.last_30days_sales*e.point;return n=n<=0?t.point:n,g=g<=0?e.point:g,g-n},L=(t,e)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime(),O=(t,e)=>(t.point===""&&(t.last_30days_sales="0"),e.point===""&&(e.last_30days_sales="0"),e.last_30days_sales-t.last_30days_sales),G=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),e.point-t.point),Z=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),t.point-e.point),v=t=>{const e=[];for(let n=0;n<t.length;n+=V)e.push(t.slice(n,n+V));return e},q=()=>{r.sort(I),c.value=v(r)},Q=()=>{r.sort(L),c.value=v(r)},U=()=>{r.sort(O),c.value=v(r)},W=()=>{r.sort(G),c.value=v(r)},X=()=>{r.sort(Z),c.value=v(r)},J=(t,e)=>'<span class="'+e+'">'+(t+1)+"</span>",K=()=>{window.scrollTo(0,0)};return(t,e)=>{const n=st,g=ot,j=nt,Y=at,tt=dt,et=pt;return l(),u("div",yt,[s("div",bt,[wt,o(),s("div",xt,[s("ul",Ct,[_(g,null,{default:m(()=>[(l(!0),u(b,null,w(i(H),(a,k)=>(l(),u("li",{key:k,class:"mx-3"},[_(n,{class:"d-flex align-items-center position-relative pb-2",to:`/${a.category_url}`},{default:m(()=>[s("div",St,h(a.category_name),1)]),_:2},1032,["to"]),o(),a.sub_categories?(l(),u("div",kt,[(l(!0),u(b,null,w(a.sub_categories,(d,E)=>(l(),u("div",{key:E,class:"page_Cat_Sub"},[_(n,{to:`/${a.category_url}/${d.sub_url}`},{default:m(()=>[o(h(d.sub_name),1)]),_:2},1032,["to"])]))),128))])):F("",!0)]))),128))]),_:1})])])]),o(),s("div",$t,[s("div",Bt,[_(j,{name:"house-door-fill",class:"icon"}),o(),_(j,{name:"chevron-double-right",class:"icon mx-2"}),o(),_(n,{to:{path:`/${i(S)}`,hash:""}},{default:m(()=>[s("div",{ref_key:"DOM_ch_category",ref:T},null,512)]),_:1},8,["to"])]),o(),s("div",Nt,[(l(!0),u(b,null,w(i(N),(a,k)=>(l(),u("div",{class:"subItem_text bg-light col-4 col-md-3",key:k},[_(n,{to:`/${i(S)}/${a.sub_url}`},{default:m(()=>[o(h(a.sub_name),1)]),_:2},1032,["to"])]))),128))]),o(),s("div",Dt,[Pt,o(),s("div",Mt,[s("button",{class:x({active:i(f)==="complex"}),onClick:e[0]||(e[0]=a=>{y("complex"),q()})},"綜合排名",2),o(),s("button",{class:x({active:i(f)==="time"}),onClick:e[1]||(e[1]=a=>{y("time"),Q()})},"最新",2),o(),s("button",{class:x({active:i(f)==="hot"}),onClick:e[2]||(e[2]=a=>{y("hot"),U()})},"最熱銷",2),o(),s("button",{class:x({active:i(f)==="point_height"}),onClick:e[3]||(e[3]=a=>{y("point_height"),W()})},"點數高",2),o(),s("button",{class:x({active:i(f)==="point_low"}),onClick:e[4]||(e[4]=a=>{y("point_low"),X()})},"點數低",2)])]),o(),s("div",Rt,[_(g,null,{default:m(()=>[s("ul",Tt,[_(et,{speed:0,autoHeight:!0,modules:["SwiperGrid"in t?t.SwiperGrid:i(ct),"SwiperPagination"in t?t.SwiperPagination:i(ut)],"slides-per-view":1,"slides-per-group":1,"space-between":50,loop:!1,pagination:{clickable:!0,type:"bullets",renderBullet:J},onPaginationRender:K},{default:m(()=>[(l(!0),u(b,null,w(i(c),(a,k)=>(l(),_t(tt,{class:"d-flex align-items-baseline justify-content-between flex-wrap"},{default:m(()=>[(l(!0),u(b,null,w(a,(d,E)=>(l(),u("li",Ht,[_(n,{class:"disabled-link",to:{path:"/",hash:""}},{default:m(()=>[_(Y,{class:"lazyload",itemprop:"image",src:`${d.picture_url}`,"data-src":`${d.picture_url}`},null,8,["src","data-src"])]),_:2},1024),o(),s("div",jt,[o(h(d.item_name)+" ",1),d.spec!==""&&d.spec!=="無"?(l(),u("span",Et," : "+h(d.spec),1)):F("",!0)]),o(),s("div",Ft,h(("formatNumber"in t?t.formatNumber:i(ht))(d.point))+` 菓子點
                                `,1),o(),Vt]))),256))]),_:2},1024))),256))]),_:1},8,["modules","pagination"])])]),_:1})])])])}}});export{Zt as default};
