import{_ as at,a as nt}from"./DN3K4QaC.js";import{_ as lt,a as it}from"./D_TQDmU0.js";import{d as rt,a as d,M as ct,x as P,N as ut,z as r,A as u,D as s,F as o,B as _,C as m,u as i,O as w,P as x,Q as C,E as h,R as z,U as _t,V as dt,H as pt,W as mt,X as gt,Y as ft,Z as vt}from"./CB_E7rYp.js";import{u as ht,c as yt,a as bt,b as wt,_ as xt}from"./CV9-J-Yb.js";import{f as Ct}from"./clxyF2lu.js";const I=S=>(mt("data-v-fa95c685"),S=S(),gt(),S),St={class:"page_main container d-flex justify-content-between"},kt={class:"div_page_left col-md-2 bg-light"},$t=I(()=>s("div",{class:"menu_title"},[s("div",null,"分類找商品")],-1)),Bt={class:"menu_item"},Nt={class:"me-3"},Dt={class:"text d-flex align-items-center"},Pt={key:0},It={class:"div_page_right col-md-9 col-12 bg-light"},Mt={class:"page_header_breadcrumb d-flex align-items-center"},Rt={class:"page_subItem d-flex align-items-center justify-content-between flex-wrap"},Tt={class:"d-flex align-items-center justify-content-start control_bar"},Ht=I(()=>s("div",{class:"control_label"},"篩選",-1)),jt={class:"control_options"},Et={class:"page_itemBody mt-3"},Ft={class:"d-flex align-items-baseline justify-content-between flex-wrap"},Vt={class:""},zt={class:"title"},At={key:0},Lt={class:"point"},Ot=I(()=>s("button",{class:"nutton d-none"},"點數兌換",-1)),A=18,Gt=rt({__name:"[subCategory]",async setup(S){let k,M;const R=ht().currentRoute.value,y=R.params.category;let T=d(!1),B=d([]),N=d([]),H=d("");const j=d(null),{$MenuItemsData:L}=wt(),E=d(L);let n=d(),p=d();const f=d("complex");d(),ct(()=>{if(P(E.value).forEach((t,e)=>{t.category_url===y&&(B=P(t),j.value.textContent=B.category_name,N.value=B.sub_categories,N.value.forEach((a,g)=>{a.sub_url===R.params.subCategory&&(H.value=a.sub_name)}),T.value=!0)}),!T.value)throw console.log("Not ==="),yt({statusCode:404,statusMessage:"Page Not Found",fatal:!0});n?n=n.filter(t=>t.sub_category===H.value):console.log("No data"),p.value=n,p.value=v(p.value)});const{data:O,refresh:Zt}=([k,M]=ut(()=>bt(`https://isnmk.com/api/${y}`,"$yF3ZZRwgqw")),k=await k,M(),k);n=P(O.value);const b=t=>{f.value=t},G=(t,e)=>{let a=t.last_30days_sales*t.point,g=e.last_30days_sales*e.point;return a=a<=0?t.point:a,g=g<=0?e.point:g,g-a},Z=(t,e)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime(),q=(t,e)=>(t.point===""&&(t.last_30days_sales="0"),e.point===""&&(e.last_30days_sales="0"),e.last_30days_sales-t.last_30days_sales),Q=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),e.point-t.point),U=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),t.point-e.point),v=t=>{const e=[];for(let a=0;a<t.length;a+=A)e.push(t.slice(a,a+A));return e},F=()=>{n.sort(G),p.value=v(n)},W=()=>{n.sort(Z),p.value=v(n)},X=()=>{n.sort(q),p.value=v(n)},Y=()=>{n.sort(Q),p.value=v(n)},J=()=>{n.sort(U),p.value=v(n)};F();const K=(t,e)=>'<span class="'+e+'">'+(t+1)+"</span>",tt=()=>{window.scrollTo(0,0)};return(t,e)=>{const a=at,g=nt,D=lt,et=it,st=ft,ot=vt;return r(),u("div",St,[s("div",kt,[$t,o(),s("div",Bt,[s("ul",Nt,[_(g,null,{default:m(()=>[(r(!0),u(w,null,x(i(E),(l,$)=>(r(),u("li",{key:$,class:"mx-3"},[_(a,{class:"d-flex align-items-center position-relative pb-2",to:`/${l.category_url}`},{default:m(()=>[s("div",Dt,h(l.category_name),1)]),_:2},1032,["to"]),o(),l.sub_categories?(r(),u("div",Pt,[(r(!0),u(w,null,x(l.sub_categories,(c,V)=>(r(),u("div",{key:V,class:"page_Cat_Sub"},[_(a,{to:`/${l.category_url}/${c.sub_url}`},{default:m(()=>[o(h(c.sub_name),1)]),_:2},1032,["to"])]))),128))])):z("",!0)]))),128))]),_:1})])])]),o(),s("div",It,[s("div",Mt,[_(D,{name:"house-door-fill",class:"icon"}),o(),_(D,{name:"chevron-double-right",class:"icon mx-2"}),o(),_(a,{to:{path:`/${i(y)}`,hash:""}},{default:m(()=>[s("div",{ref_key:"DOM_ch_category",ref:j},null,512)]),_:1},8,["to"])]),o(),s("div",Rt,[(r(!0),u(w,null,x(i(N),(l,$)=>(r(),u("div",{class:"subItem_text bg-light col-12 col-md-3",key:$},[_(a,{to:`/${i(y)}/${l.sub_url}`},{default:m(()=>[_(D,{class:"mobile",name:"chevron-right"}),o(" "+h(l.sub_name),1)]),_:2},1032,["to"])]))),128))]),o(),s("div",Tt,[Ht,o(),s("div",jt,[s("button",{class:C({active:i(f)==="complex"}),onClick:e[0]||(e[0]=l=>{b("complex"),F()})},"綜合",2),o(),s("button",{class:C({active:i(f)==="time"}),onClick:e[1]||(e[1]=l=>{b("time"),W()})},"最新",2),o(),s("button",{class:C({active:i(f)==="hot"}),onClick:e[2]||(e[2]=l=>{b("hot"),X()})},"熱門",2),o(),s("button",{class:C({active:i(f)==="point_height"}),onClick:e[3]||(e[3]=l=>{b("point_height"),Y()})},"價高",2),o(),s("button",{class:C({active:i(f)==="point_low"}),onClick:e[4]||(e[4]=l=>{b("point_low"),J()})},"價低",2)])]),o(),s("div",Et,[_(g,null,{default:m(()=>[s("ul",Ft,[_(ot,{speed:0,autoHeight:!0,modules:["SwiperGrid"in t?t.SwiperGrid:i(_t),"SwiperPagination"in t?t.SwiperPagination:i(dt)],"slides-per-view":1,"slides-per-group":1,"space-between":50,loop:!1,pagination:{clickable:!0,type:"bullets",renderBullet:K},onPaginationRender:tt},{default:m(()=>[(r(!0),u(w,null,x(i(p),(l,$)=>(r(),pt(st,{class:"d-flex align-items-baseline justify-content-between flex-wrap"},{default:m(()=>[(r(!0),u(w,null,x(l,(c,V)=>(r(),u("li",Vt,[_(a,{class:"disabled-links",to:{name:"items-id",params:{id:c.item_code},query:{category:i(y),itemCode:c.item_code}}},{default:m(()=>[_(et,{class:"lazyload",itemprop:"image",src:`${c.picture_url}`,"data-src":`${c.picture_url}`},null,8,["src","data-src"])]),_:2},1032,["to"]),o(),s("div",zt,[o(h(c.item_name)+" ",1),c.spec!==""&&c.spec!=="無"?(r(),u("span",At," : "+h(c.spec),1)):z("",!0)]),o(),s("div",Lt,h(("formatNumber"in t?t.formatNumber:i(Ct))(c.point))+` 菓子點
                                `,1),o(),Ot]))),256))]),_:2},1024))),256))]),_:1},8,["modules","pagination"])])]),_:1})])])])}}}),Yt=xt(Gt,[["__scopeId","data-v-fa95c685"]]);export{Yt as default};
