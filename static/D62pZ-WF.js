import{_ as tt,a as et,b as st,c as ot}from"./DmlwYuYq.js";import{d as nt,a as p,M as at,x as B,N as lt,z as l,A as c,D as s,F as o,B as u,C as m,u as i,O as b,P as x,Q as w,E as h,R as F,U as it,V as rt,H as ct,W as ut,X as _t}from"./BdXk0Eed.js";import{u as dt,c as pt,a as mt,b as gt}from"./CYyNYUtc.js";import{f as ft}from"./clxyF2lu.js";const vt={class:"page_main container d-flex justify-content-between"},ht={class:"div_page_left col-md-2 bg-light"},yt=s("div",{class:"menu_title"},[s("div",null,"分類找商品")],-1),bt={class:"menu_item"},xt={class:"me-3"},wt={class:"text d-flex align-items-center"},Ct={key:0},kt={class:"div_page_right col-md-9 col-12 bg-light"},St={class:"page_header_breadcrumb d-flex align-items-center"},$t={class:"page_subItem d-flex align-items-center justify-content-between flex-wrap"},Bt={class:"d-flex align-items-center justify-content-start control_bar"},Dt=s("div",{class:"control_label"},"篩選",-1),Nt={class:"control_options"},Pt={class:"page_itemBody mt-3"},Mt={class:"d-flex align-items-baseline justify-content-between flex-wrap"},Ht={class:""},Rt={class:"title"},Tt={key:0},jt={class:"point"},Ft=s("button",{class:"nutton d-none"},"點數兌換",-1),V=18,Gt=nt({__name:"index",async setup(Vt){let C,D;const k=dt().currentRoute.value.params.category;let N=p(!1),$=p([]),P=p([]);const M=p(null),{$MenuItemsData:z}=gt(),H=p(z);let r=p(),d=p();const f=p("complex");p(),at(()=>{if(B(H.value).forEach((t,e)=>{t.category_url===k&&($=B(t),M.value.textContent=$.category_name,P.value=$.sub_categories,N.value=!0)}),!N.value)throw console.log("Not ==="),pt({statusCode:404,statusMessage:"Page Not Found",fatal:!0})});const{data:A,refresh:At}=([C,D]=lt(()=>mt(`https://isnmk.com/api/${k}`,"$lUdZf5FrkZ")),C=await C,D(),C);r=B(A.value),d.value=r;const y=t=>{f.value=t},E=(t,e)=>{let n=t.last_30days_sales*t.point,g=e.last_30days_sales*e.point;return n=n<=0?t.point:n,g=g<=0?e.point:g,g-n},I=(t,e)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime(),L=(t,e)=>(t.point===""&&(t.last_30days_sales="0"),e.point===""&&(e.last_30days_sales="0"),e.last_30days_sales-t.last_30days_sales),O=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),e.point-t.point),G=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),t.point-e.point),v=t=>{const e=[];for(let n=0;n<t.length;n+=V)e.push(t.slice(n,n+V));return e};d.value=v(d.value);const R=()=>{r.sort(E),d.value=v(r)},U=()=>{r.sort(I),d.value=v(r)},Z=()=>{r.sort(L),d.value=v(r)},Q=()=>{r.sort(O),d.value=v(r)},W=()=>{r.sort(G),d.value=v(r)};R();const X=(t,e)=>'<span class="'+e+'">'+(t+1)+"</span>",q=()=>{window.scrollTo(0,0)};return(t,e)=>{const n=tt,g=et,T=st,J=ot,K=ut,Y=_t;return l(),c("div",vt,[s("div",ht,[yt,o(),s("div",bt,[s("ul",xt,[u(g,null,{default:m(()=>[(l(!0),c(b,null,x(i(H),(a,S)=>(l(),c("li",{key:S,class:"mx-3"},[u(n,{class:"d-flex align-items-center position-relative pb-2",to:`/${a.category_url}`},{default:m(()=>[s("div",wt,h(a.category_name),1)]),_:2},1032,["to"]),o(),a.sub_categories?(l(),c("div",Ct,[(l(!0),c(b,null,x(a.sub_categories,(_,j)=>(l(),c("div",{key:j,class:"page_Cat_Sub"},[u(n,{to:`/${a.category_url}/${_.sub_url}`},{default:m(()=>[o(h(_.sub_name),1)]),_:2},1032,["to"])]))),128))])):F("",!0)]))),128))]),_:1})])])]),o(),s("div",kt,[s("div",St,[u(T,{name:"house-door-fill",class:"icon"}),o(),u(T,{name:"chevron-double-right",class:"icon mx-2"}),o(),u(n,{to:{path:`/${i(k)}`,hash:""}},{default:m(()=>[s("div",{ref_key:"DOM_ch_category",ref:M},null,512)]),_:1},8,["to"])]),o(),s("div",$t,[(l(!0),c(b,null,x(i(P),(a,S)=>(l(),c("div",{class:"subItem_text bg-light col-12 col-md-3",key:S},[u(n,{to:`/${i(k)}/${a.sub_url}`},{default:m(()=>[o(h(a.sub_name),1)]),_:2},1032,["to"])]))),128))]),o(),s("div",Bt,[Dt,o(),s("div",Nt,[s("button",{class:w({active:i(f)==="complex"}),onClick:e[0]||(e[0]=a=>{y("complex"),R()})},"綜合",2),o(),s("button",{class:w({active:i(f)==="time"}),onClick:e[1]||(e[1]=a=>{y("time"),U()})},"最新",2),o(),s("button",{class:w({active:i(f)==="hot"}),onClick:e[2]||(e[2]=a=>{y("hot"),Z()})},"熱門",2),o(),s("button",{class:w({active:i(f)==="point_height"}),onClick:e[3]||(e[3]=a=>{y("point_height"),Q()})},"價高",2),o(),s("button",{class:w({active:i(f)==="point_low"}),onClick:e[4]||(e[4]=a=>{y("point_low"),W()})},"價低",2)])]),o(),s("div",Pt,[u(g,null,{default:m(()=>[s("ul",Mt,[u(Y,{speed:0,autoHeight:!0,modules:["SwiperGrid"in t?t.SwiperGrid:i(it),"SwiperPagination"in t?t.SwiperPagination:i(rt)],"slides-per-view":1,"slides-per-group":1,"space-between":50,loop:!1,pagination:{clickable:!0,type:"bullets",renderBullet:X},onPaginationRender:q},{default:m(()=>[(l(!0),c(b,null,x(i(d),(a,S)=>(l(),ct(K,{class:"d-flex align-items-baseline justify-content-between flex-wrap"},{default:m(()=>[(l(!0),c(b,null,x(a,(_,j)=>(l(),c("li",Ht,[u(n,{class:"disabled-link",to:{path:"/",hash:""}},{default:m(()=>[u(J,{class:"lazyload",itemprop:"image",src:`${_.picture_url}`,"data-src":`${_.picture_url}`},null,8,["src","data-src"])]),_:2},1024),o(),s("div",Rt,[o(h(_.item_name)+" ",1),_.spec!==""&&_.spec!=="無"?(l(),c("span",Tt," : "+h(_.spec),1)):F("",!0)]),o(),s("div",jt,h(("formatNumber"in t?t.formatNumber:i(ft))(_.point))+` 菓子點
                                `,1),o(),Ft]))),256))]),_:2},1024))),256))]),_:1},8,["modules","pagination"])])]),_:1})])])])}}});export{Gt as default};
