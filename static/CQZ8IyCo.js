import{_ as U,a as W,b as X,c as Y}from"./lBtpeWHR.js";import{d as tt,u as et,r as l,o as ot,t as C,c as st,w as nt,a as r,b as c,e as o,f as a,g as d,h as p,i as _,F as w,j as k,n as v,k as at,l as g,m as E,p as lt}from"./DriScr-K.js";import{f as it}from"./clxyF2lu.js";const rt={class:"page_main container d-flex justify-content-between"},ct={class:"div_page_left col-md-2 bg-light"},_t=o("div",{class:"menu_title"},[o("div",null,"分類找商品")],-1),ut={class:"menu_item"},dt={class:"me-3"},pt={class:"text d-flex align-items-center"},mt={key:0},gt={class:"div_page_right col-md-9 col-12 bg-light"},ft={class:"page_header_breadcrumb d-flex align-items-center"},vt={class:"page_subItem d-flex align-items-center justify-content-between flex-wrap"},ht={class:"d-flex align-items-center justify-content-start control_bar"},yt=o("div",{class:"control_label"},"篩選",-1),bt={class:"control_options"},xt={class:"page_itemBody mt-3"},Ct={class:"d-flex align-items-baseline justify-content-between flex-wrap"},wt={class:""},kt={class:"title"},$t={key:0},Nt={class:"point"},Bt=o("button",{class:"nutton d-none"},"點數兌換",-1),Ft=tt({__name:"[subCategory]",async setup(Dt){let h,B;const D=et().currentRoute.value,y=D.params.category;let S=l(!1),b=l([]),$=l([]),M=l("");const T=l(null),{$MenuItemsData:H}=lt(),j=l(H);let n=l(),F=l([]);const m=l("");l(),ot(()=>{if(j.value.forEach((t,i)=>{t.category_url===y&&(b=C(t),console.log(b),T.value.textContent=b.category_name,$.value=b.sub_categories,$.value.forEach((u,N)=>{u.sub_url===D.params.subCategory&&(M.value=u.sub_name)}),S.value=!0)}),!S.value)throw console.log("Not ==="),st({statusCode:404,statusMessage:"Page Not Found",fatal:!0});let e=l([]);n=l(C(n.value)),n?n=n.value.filter(t=>t.sub_category===M.value):console.log("No data");for(let t in n)e.value.push(n[t]);n=e});const{data:I,refresh:St}=([h,B]=nt(()=>at(`https://isnmk.com/api/${y}`,"$yF3ZZRwgqw")),h=await h,B(),h);n=C(I.value);const f=e=>{m.value=e},L=(e,t)=>{let i=e.last_30days_sales*e.point,u=t.last_30days_sales*t.point;return i=i<=0?e.point:i,u=u<=0?t.point:u,u-i},R=(e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime(),V=(e,t)=>(e.point===""&&(e.last_30days_sales="0"),t.point===""&&(t.last_30days_sales="0"),t.last_30days_sales-e.last_30days_sales),A=(e,t)=>(e.point===""&&(e.point="99999"),t.point===""&&(t.point="99999"),t.point-e.point),O=(e,t)=>(e.point===""&&(e.point="99999"),t.point===""&&(t.point="99999"),e.point-t.point);for(let e in n)F.value.push(n[e]);n=F;const z=()=>{console.log(n),n.value.sort(L)},Z=()=>{n.value.sort(R)},q=()=>{n.value.sort(V)},G=()=>{n.value.sort(A)},J=()=>{console.log(C(n)),n.value.sort(O)};return(e,t)=>{const i=U,u=W,N=X,K=Y;return r(),c("div",rt,[o("div",ct,[_t,a(),o("div",ut,[o("ul",dt,[d(u,null,{default:p(()=>[(r(!0),c(w,null,k(_(j),(s,x)=>(r(),c("li",{key:x,class:"mx-3"},[d(i,{class:"d-flex align-items-center position-relative pb-2",to:`/${s.category_url}`},{default:p(()=>[o("div",pt,g(s.category_name),1)]),_:2},1032,["to"]),a(),s.sub_categories?(r(),c("div",mt,[(r(!0),c(w,null,k(s.sub_categories,(P,Q)=>(r(),c("div",{key:Q,class:"page_Cat_Sub"},[d(i,{to:`/${s.category_url}/${P.sub_url}`},{default:p(()=>[a(g(P.sub_name),1)]),_:2},1032,["to"])]))),128))])):E("",!0)]))),128))]),_:1})])])]),a(),o("div",gt,[o("div",ft,[d(N,{name:"house-door-fill",class:"icon"}),a(),d(N,{name:"chevron-double-right",class:"icon mx-2"}),a(),d(i,{to:{path:`/${_(y)}`,hash:""}},{default:p(()=>[o("div",{ref_key:"DOM_ch_category",ref:T},null,512)]),_:1},8,["to"])]),a(),o("div",vt,[(r(!0),c(w,null,k(_($),(s,x)=>(r(),c("div",{class:"subItem_text bg-light col-4 col-md-3",key:x},[d(i,{to:`/${_(y)}/${s.sub_url}`},{default:p(()=>[a(g(s.sub_name),1)]),_:2},1032,["to"])]))),128))]),a(),o("div",ht,[yt,a(),o("div",bt,[o("button",{class:v({active:_(m)==="complex"}),onClick:t[0]||(t[0]=s=>{f("complex"),z()})},"綜合排名",2),a(),o("button",{class:v({active:_(m)==="time"}),onClick:t[1]||(t[1]=s=>{f("time"),Z()})},"最新",2),a(),o("button",{class:v({active:_(m)==="hot"}),onClick:t[2]||(t[2]=s=>{f("hot"),q()})},"最熱銷",2),a(),o("button",{class:v({active:_(m)==="point_height"}),onClick:t[3]||(t[3]=s=>{f("point_height"),G()})},"點數高",2),a(),o("button",{class:v({active:_(m)==="point_low"}),onClick:t[4]||(t[4]=s=>{f("point_low"),J()})},"點數低",2)])]),a(),o("div",xt,[d(u,null,{default:p(()=>[o("ul",Ct,[(r(!0),c(w,null,k(_(n),(s,x)=>(r(),c("li",wt,[d(i,{class:"disabled-link",to:{path:"/",hash:""}},{default:p(()=>[d(K,{class:"lazyload",itemprop:"image",src:`${s.picture_url}`,"data-src":`${s.picture_url}`},null,8,["src","data-src"])]),_:2},1024),a(),o("div",kt,[a(g(s.item_name)+" ",1),s.spec!==""&&s.spec!=="無"?(r(),c("span",$t," : "+g(s.spec),1)):E("",!0)]),a(),o("div",Nt,g(("formatNumber"in e?e.formatNumber:_(it))(s.point))+` 菓子點
                            `,1),a(),Bt]))),256))])]),_:1})])])])}}});export{Ft as default};
