import{_ as st,a as ot,b as nt,c as at}from"./DmlwYuYq.js";import{d as lt,a as p,M as it,x as N,N as rt,z as i,A as c,D as s,F as o,B as u,C as m,u as r,O as b,P as w,Q as x,E as h,R as V,U as ct,V as ut,H as _t,W as pt,X as dt}from"./BdXk0Eed.js";import{u as mt,c as gt,a as ft,b as vt}from"./CYyNYUtc.js";import{f as ht}from"./clxyF2lu.js";const yt={class:"page_main container d-flex justify-content-between"},bt={class:"div_page_left col-md-2 bg-light"},wt=s("div",{class:"menu_title"},[s("div",null,"分類找商品")],-1),xt={class:"menu_item"},Ct={class:"me-3"},St={class:"text d-flex align-items-center"},kt={key:0},$t={class:"div_page_right col-md-9 col-12 bg-light"},Bt={class:"page_header_breadcrumb d-flex align-items-center"},Nt={class:"page_subItem d-flex align-items-center justify-content-between flex-wrap"},Dt={class:"d-flex align-items-center justify-content-start control_bar"},Pt=s("div",{class:"control_label"},"篩選",-1),Mt={class:"control_options"},Rt={class:"page_itemBody mt-3"},Tt={class:"d-flex align-items-baseline justify-content-between flex-wrap"},Ht={class:""},jt={class:"title"},Et={key:0},Ft={class:"point"},Vt=s("button",{class:"nutton d-none"},"點數兌換",-1),z=18,Zt=lt({__name:"[subCategory]",async setup(zt){let C,D;const P=mt().currentRoute.value,S=P.params.category;let M=p(!1),$=p([]),B=p([]),R=p("");const T=p(null),{$MenuItemsData:A}=vt(),H=p(A);let a=p(),d=p();const f=p("complex");p(),it(()=>{if(N(H.value).forEach((t,e)=>{t.category_url===S&&($=N(t),T.value.textContent=$.category_name,B.value=$.sub_categories,B.value.forEach((n,g)=>{n.sub_url===P.params.subCategory&&(R.value=n.sub_name)}),M.value=!0)}),!M.value)throw console.log("Not ==="),gt({statusCode:404,statusMessage:"Page Not Found",fatal:!0});a?a=a.filter(t=>t.sub_category===R.value):console.log("No data"),d.value=a,d.value=v(d.value)});const{data:I,refresh:At}=([C,D]=rt(()=>ft(`https://isnmk.com/api/${S}`,"$yF3ZZRwgqw")),C=await C,D(),C);a=N(I.value);const y=t=>{f.value=t},L=(t,e)=>{let n=t.last_30days_sales*t.point,g=e.last_30days_sales*e.point;return n=n<=0?t.point:n,g=g<=0?e.point:g,g-n},O=(t,e)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime(),G=(t,e)=>(t.point===""&&(t.last_30days_sales="0"),e.point===""&&(e.last_30days_sales="0"),e.last_30days_sales-t.last_30days_sales),Z=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),e.point-t.point),q=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),t.point-e.point),v=t=>{const e=[];for(let n=0;n<t.length;n+=z)e.push(t.slice(n,n+z));return e},j=()=>{a.sort(L),d.value=v(a)},Q=()=>{a.sort(O),d.value=v(a)},U=()=>{a.sort(G),d.value=v(a)},W=()=>{a.sort(Z),d.value=v(a)},X=()=>{a.sort(q),d.value=v(a)};j();const J=(t,e)=>'<span class="'+e+'">'+(t+1)+"</span>",K=()=>{window.scrollTo(0,0)};return(t,e)=>{const n=st,g=ot,E=nt,Y=at,tt=pt,et=dt;return i(),c("div",yt,[s("div",bt,[wt,o(),s("div",xt,[s("ul",Ct,[u(g,null,{default:m(()=>[(i(!0),c(b,null,w(r(H),(l,k)=>(i(),c("li",{key:k,class:"mx-3"},[u(n,{class:"d-flex align-items-center position-relative pb-2",to:`/${l.category_url}`},{default:m(()=>[s("div",St,h(l.category_name),1)]),_:2},1032,["to"]),o(),l.sub_categories?(i(),c("div",kt,[(i(!0),c(b,null,w(l.sub_categories,(_,F)=>(i(),c("div",{key:F,class:"page_Cat_Sub"},[u(n,{to:`/${l.category_url}/${_.sub_url}`},{default:m(()=>[o(h(_.sub_name),1)]),_:2},1032,["to"])]))),128))])):V("",!0)]))),128))]),_:1})])])]),o(),s("div",$t,[s("div",Bt,[u(E,{name:"house-door-fill",class:"icon"}),o(),u(E,{name:"chevron-double-right",class:"icon mx-2"}),o(),u(n,{to:{path:`/${r(S)}`,hash:""}},{default:m(()=>[s("div",{ref_key:"DOM_ch_category",ref:T},null,512)]),_:1},8,["to"])]),o(),s("div",Nt,[(i(!0),c(b,null,w(r(B),(l,k)=>(i(),c("div",{class:"subItem_text bg-light col-12 col-md-3",key:k},[u(n,{to:`/${r(S)}/${l.sub_url}`},{default:m(()=>[o(h(l.sub_name),1)]),_:2},1032,["to"])]))),128))]),o(),s("div",Dt,[Pt,o(),s("div",Mt,[s("button",{class:x({active:r(f)==="complex"}),onClick:e[0]||(e[0]=l=>{y("complex"),j()})},"綜合",2),o(),s("button",{class:x({active:r(f)==="time"}),onClick:e[1]||(e[1]=l=>{y("time"),Q()})},"最新",2),o(),s("button",{class:x({active:r(f)==="hot"}),onClick:e[2]||(e[2]=l=>{y("hot"),U()})},"熱門",2),o(),s("button",{class:x({active:r(f)==="point_height"}),onClick:e[3]||(e[3]=l=>{y("point_height"),W()})},"價高",2),o(),s("button",{class:x({active:r(f)==="point_low"}),onClick:e[4]||(e[4]=l=>{y("point_low"),X()})},"價低",2)])]),o(),s("div",Rt,[u(g,null,{default:m(()=>[s("ul",Tt,[u(et,{speed:0,autoHeight:!0,modules:["SwiperGrid"in t?t.SwiperGrid:r(ct),"SwiperPagination"in t?t.SwiperPagination:r(ut)],"slides-per-view":1,"slides-per-group":1,"space-between":50,loop:!1,pagination:{clickable:!0,type:"bullets",renderBullet:J},onPaginationRender:K},{default:m(()=>[(i(!0),c(b,null,w(r(d),(l,k)=>(i(),_t(tt,{class:"d-flex align-items-baseline justify-content-between flex-wrap"},{default:m(()=>[(i(!0),c(b,null,w(l,(_,F)=>(i(),c("li",Ht,[u(n,{class:"disabled-link",to:{path:"/",hash:""}},{default:m(()=>[u(Y,{class:"lazyload",itemprop:"image",src:`${_.picture_url}`,"data-src":`${_.picture_url}`},null,8,["src","data-src"])]),_:2},1024),o(),s("div",jt,[o(h(_.item_name)+" ",1),_.spec!==""&&_.spec!=="無"?(i(),c("span",Et," : "+h(_.spec),1)):V("",!0)]),o(),s("div",Ft,h(("formatNumber"in t?t.formatNumber:r(ht))(_.point))+` 菓子點
                                `,1),o(),Vt]))),256))]),_:2},1024))),256))]),_:1},8,["modules","pagination"])])]),_:1})])])])}}});export{Zt as default};
