import{_ as nt,a as at}from"./KlCQfSXO.js";import{_ as lt,a as it}from"./VKi0ejvj.js";import{d as rt,a as p,M as ct,x as P,N as ut,z as i,A as c,D as s,F as o,B as u,C as m,u as r,O as b,P as w,Q as x,E as h,R as z,U as _t,V as pt,H as dt,W as mt,X as gt,Y as ft,Z as vt}from"./CB_E7rYp.js";import{u as ht,c as yt,a as bt,b as wt,_ as xt}from"./qtUg9gMc.js";import{f as Ct}from"./clxyF2lu.js";const I=C=>(mt("data-v-a30f8c4d"),C=C(),gt(),C),St={class:"page_main container d-flex justify-content-between"},kt={class:"div_page_left col-md-2 bg-light"},$t=I(()=>s("div",{class:"menu_title"},[s("div",null,"分類找商品")],-1)),Bt={class:"menu_item"},Nt={class:"me-3"},Dt={class:"text d-flex align-items-center"},Pt={key:0},It={class:"div_page_right col-md-9 col-12 bg-light"},Mt={class:"page_header_breadcrumb d-flex align-items-center"},Rt={class:"page_subItem d-flex align-items-center justify-content-between flex-wrap"},Tt={class:"d-flex align-items-center justify-content-start control_bar"},Ht=I(()=>s("div",{class:"control_label"},"篩選",-1)),jt={class:"control_options"},Et={class:"page_itemBody mt-3"},Ft={class:"d-flex align-items-baseline justify-content-between flex-wrap"},Vt={class:""},zt={class:"title"},At={key:0},Lt={class:"point"},Ot=I(()=>s("button",{class:"nutton d-none"},"點數兌換",-1)),A=18,Gt=rt({__name:"[subCategory]",async setup(C){let S,M;const R=ht().currentRoute.value,k=R.params.category;let T=p(!1),B=p([]),N=p([]),H=p("");const j=p(null),{$MenuItemsData:L}=wt(),E=p(L);let a=p(),d=p();const f=p("complex");p(),ct(()=>{if(P(E.value).forEach((t,e)=>{t.category_url===k&&(B=P(t),j.value.textContent=B.category_name,N.value=B.sub_categories,N.value.forEach((n,g)=>{n.sub_url===R.params.subCategory&&(H.value=n.sub_name)}),T.value=!0)}),!T.value)throw console.log("Not ==="),yt({statusCode:404,statusMessage:"Page Not Found",fatal:!0});a?a=a.filter(t=>t.sub_category===H.value):console.log("No data"),d.value=a,d.value=v(d.value)});const{data:O,refresh:Zt}=([S,M]=ut(()=>bt(`https://isnmk.com/api/${k}`,"$yF3ZZRwgqw")),S=await S,M(),S);a=P(O.value);const y=t=>{f.value=t},G=(t,e)=>{let n=t.last_30days_sales*t.point,g=e.last_30days_sales*e.point;return n=n<=0?t.point:n,g=g<=0?e.point:g,g-n},Z=(t,e)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime(),q=(t,e)=>(t.point===""&&(t.last_30days_sales="0"),e.point===""&&(e.last_30days_sales="0"),e.last_30days_sales-t.last_30days_sales),Q=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),e.point-t.point),U=(t,e)=>(t.point===""&&(t.point="99999"),e.point===""&&(e.point="99999"),t.point-e.point),v=t=>{const e=[];for(let n=0;n<t.length;n+=A)e.push(t.slice(n,n+A));return e},F=()=>{a.sort(G),d.value=v(a)},W=()=>{a.sort(Z),d.value=v(a)},X=()=>{a.sort(q),d.value=v(a)},Y=()=>{a.sort(Q),d.value=v(a)},J=()=>{a.sort(U),d.value=v(a)};F();const K=(t,e)=>'<span class="'+e+'">'+(t+1)+"</span>",tt=()=>{window.scrollTo(0,0)};return(t,e)=>{const n=nt,g=at,D=lt,et=it,st=ft,ot=vt;return i(),c("div",St,[s("div",kt,[$t,o(),s("div",Bt,[s("ul",Nt,[u(g,null,{default:m(()=>[(i(!0),c(b,null,w(r(E),(l,$)=>(i(),c("li",{key:$,class:"mx-3"},[u(n,{class:"d-flex align-items-center position-relative pb-2",to:`/${l.category_url}`},{default:m(()=>[s("div",Dt,h(l.category_name),1)]),_:2},1032,["to"]),o(),l.sub_categories?(i(),c("div",Pt,[(i(!0),c(b,null,w(l.sub_categories,(_,V)=>(i(),c("div",{key:V,class:"page_Cat_Sub"},[u(n,{to:`/${l.category_url}/${_.sub_url}`},{default:m(()=>[o(h(_.sub_name),1)]),_:2},1032,["to"])]))),128))])):z("",!0)]))),128))]),_:1})])])]),o(),s("div",It,[s("div",Mt,[u(D,{name:"house-door-fill",class:"icon"}),o(),u(D,{name:"chevron-double-right",class:"icon mx-2"}),o(),u(n,{to:{path:`/${r(k)}`,hash:""}},{default:m(()=>[s("div",{ref_key:"DOM_ch_category",ref:j},null,512)]),_:1},8,["to"])]),o(),s("div",Rt,[(i(!0),c(b,null,w(r(N),(l,$)=>(i(),c("div",{class:"subItem_text bg-light col-12 col-md-3",key:$},[u(n,{to:`/${r(k)}/${l.sub_url}`},{default:m(()=>[u(D,{class:"mobile",name:"chevron-right"}),o(" "+h(l.sub_name),1)]),_:2},1032,["to"])]))),128))]),o(),s("div",Tt,[Ht,o(),s("div",jt,[s("button",{class:x({active:r(f)==="complex"}),onClick:e[0]||(e[0]=l=>{y("complex"),F()})},"綜合",2),o(),s("button",{class:x({active:r(f)==="time"}),onClick:e[1]||(e[1]=l=>{y("time"),W()})},"最新",2),o(),s("button",{class:x({active:r(f)==="hot"}),onClick:e[2]||(e[2]=l=>{y("hot"),X()})},"熱門",2),o(),s("button",{class:x({active:r(f)==="point_height"}),onClick:e[3]||(e[3]=l=>{y("point_height"),Y()})},"價高",2),o(),s("button",{class:x({active:r(f)==="point_low"}),onClick:e[4]||(e[4]=l=>{y("point_low"),J()})},"價低",2)])]),o(),s("div",Et,[u(g,null,{default:m(()=>[s("ul",Ft,[u(ot,{speed:0,autoHeight:!0,modules:["SwiperGrid"in t?t.SwiperGrid:r(_t),"SwiperPagination"in t?t.SwiperPagination:r(pt)],"slides-per-view":1,"slides-per-group":1,"space-between":50,loop:!1,pagination:{clickable:!0,type:"bullets",renderBullet:K},onPaginationRender:tt},{default:m(()=>[(i(!0),c(b,null,w(r(d),(l,$)=>(i(),dt(st,{class:"d-flex align-items-baseline justify-content-between flex-wrap"},{default:m(()=>[(i(!0),c(b,null,w(l,(_,V)=>(i(),c("li",Vt,[u(n,{class:"disabled-link",to:{path:"/",hash:""}},{default:m(()=>[u(et,{class:"lazyload",itemprop:"image",src:`${_.picture_url}`,"data-src":`${_.picture_url}`},null,8,["src","data-src"])]),_:2},1024),o(),s("div",zt,[o(h(_.item_name)+" ",1),_.spec!==""&&_.spec!=="無"?(i(),c("span",At," : "+h(_.spec),1)):z("",!0)]),o(),s("div",Lt,h(("formatNumber"in t?t.formatNumber:r(Ct))(_.point))+` 菓子點
                                `,1),o(),Ot]))),256))]),_:2},1024))),256))]),_:1},8,["modules","pagination"])])]),_:1})])])])}}}),Yt=xt(Gt,[["__scopeId","data-v-a30f8c4d"]]);export{Yt as default};
